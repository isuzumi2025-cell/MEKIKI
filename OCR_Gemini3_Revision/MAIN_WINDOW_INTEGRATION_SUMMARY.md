# ğŸ¯ MainWindow çµ±åˆå®Œäº†ã‚µãƒãƒªãƒ¼

## âœ… å®Ÿè£…å†…å®¹

`app/gui/main_window.py` ã« NavigationPanel ã¨æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ©Ÿèƒ½ã‚’å®Œå…¨çµ±åˆã—ã¾ã—ãŸã€‚

---

## ğŸ“¦ æ›´æ–°ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«

### **`app/gui/main_window.py`** (ç´„350è¡Œ)

**è¿½åŠ ã•ã‚ŒãŸæ©Ÿèƒ½:**

#### 1. **NavigationPanel çµ±åˆ**
- âœ… `NavigationPanel` ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨
- âœ… 9ã¤ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­å®š
- âœ… `PanedWindow` ã§ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹ç¯‰

#### 2. **ã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆ**
- âœ… `OCREngine` åˆæœŸåŒ–
- âœ… `ContentAnalyzer` åˆæœŸåŒ–
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆcredentials.jsonãªã—å¯¾å¿œï¼‰

#### 3. **ãƒ“ãƒ¥ãƒ¼ç®¡ç†**
- âœ… ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢
- âœ… MacroViewï¼ˆå…¨ä½“ãƒãƒƒãƒ—ï¼‰
- âœ… MicroViewï¼ˆè©³ç´°æ¯”è¼ƒï¼‰
- âœ… ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢

#### 4. **æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ©Ÿèƒ½**
- âœ… `open_new_project_dialog()` - ãƒ€ã‚¤ã‚¢ãƒ­ã‚°èµ·å‹•
- âœ… `start_analysis(config)` - åˆ†æãƒ—ãƒ­ã‚»ã‚¹
- âœ… `_crawl_web_pages()` - Webã‚¯ãƒ­ãƒ¼ãƒ«
- âœ… `_load_pdf_pages()` - PDFèª­è¾¼
- âœ… ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†ï¼ˆthreadingï¼‰
- âœ… ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ›´æ–°

#### 5. **ãã®ä»–ã®æ©Ÿèƒ½**
- âœ… `match_all()` - ä¸€æ‹¬ãƒãƒƒãƒãƒ³ã‚°
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- âœ… å®Œäº†é€šçŸ¥

---

## ğŸ¨ UIæ§‹æˆ

### ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆ1600x900ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OCR æ¯”è¼ƒãƒ„ãƒ¼ãƒ« - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                  â”‚
â”‚ Nav      â”‚     Content Area                 â”‚
â”‚ Panel    â”‚                                  â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â• æ–°è¦   â”‚  â”‚  ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢         â”‚     â”‚
â”‚          â”‚  â”‚  MacroView             â”‚     â”‚
â”‚ ğŸ—ºï¸ ãƒãƒƒãƒ— â”‚  â”‚  MicroView             â”‚     â”‚
â”‚          â”‚  â”‚  ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢       â”‚     â”‚
â”‚ ğŸ“‚ èª­è¾¼   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚ ğŸŒ Web   â”‚                                  â”‚
â”‚ ğŸ“ PDF   â”‚                                  â”‚
â”‚          â”‚                                  â”‚
â”‚ âš™ï¸ å‡¦ç†  â”‚                                  â”‚
â”‚ âš¡ Match â”‚                                  â”‚
â”‚          â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ä½¿ç”¨ãƒ•ãƒ­ãƒ¼

### åŸºæœ¬çš„ãªæ“ä½œ

```
1. ã‚¢ãƒ—ãƒªèµ·å‹•
   python app/gui/main_window.py
   ã¾ãŸã¯
   python test_main_window.py
   â†“
2. ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢è¡¨ç¤º
   â†“
3. ã€Œâ• æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ã‚¯ãƒªãƒƒã‚¯
   â†“
4. ProjectDialog ã§è¨­å®š
   - URL: https://example.com
   - PDF: document.pdf
   - OCR: æœ‰åŠ¹
   - é–¾å€¤: 30%
   â†“
5. ã€ŒğŸš€ åˆ†æé–‹å§‹ã€ã‚¯ãƒªãƒƒã‚¯
   â†“
6. ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢
   ğŸŒ Webã‚¯ãƒ­ãƒ¼ãƒ«ä¸­...
   ğŸ“ PDFèª­è¾¼ä¸­...
   ğŸ” OCRå®Ÿè¡Œä¸­...
   âš¡ ãƒãƒƒãƒãƒ³ã‚°ä¸­...
   â†“
7. å®Œäº†ãƒ€ã‚¤ã‚¢ãƒ­ã‚°
   â†“
8. MacroView è¡¨ç¤º
```

---

## ğŸ”§ æŠ€è¡“å®Ÿè£…

### ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨­å®š

```python
nav_callbacks = {
    "new_project": self.open_new_project_dialog,
    "show_macro_view": self.show_macro_view,
    "crawl_web": self.crawl_web,
    "load_pdfs": self.load_pdfs,
    "match_all": self.match_all,
    "run_ocr": self.run_ocr,
    "export_excel": self.export_excel,
    "save_project": self.save_project,
    "load_project": self.load_project
}
```

### ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†

```python
def start_analysis(self, config):
    def _run_analysis():
        try:
            # å‡¦ç†...
            self.after(0, completion_callback)
        except Exception as e:
            self.after(0, error_callback)
        finally:
            self.after(0, self.nav_panel.hide_progress)
    
    threading.Thread(target=_run_analysis, daemon=True).start()
```

### ãƒ“ãƒ¥ãƒ¼åˆ‡æ›¿

```python
def show_macro_view(self):
    if self.current_view:
        self.current_view.pack_forget()
    
    if not self.macro_view:
        self.macro_view = MacroView(
            self.content_area,
            analyzer=self.analyzer,
            on_detail_click=self._open_micro_view
        )
    
    self.macro_view.pack(fill="both", expand=True)
    self.current_view = self.macro_view
```

---

## ğŸ“Š çµ±è¨ˆæƒ…å ±

| é …ç›® | å€¤ |
|------|-----|
| ç·è¡Œæ•° | ~350è¡Œ |
| ãƒ¡ã‚½ãƒƒãƒ‰æ•° | 21å€‹ |
| ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯æ•° | 9å€‹ |
| ãƒ“ãƒ¥ãƒ¼æ•° | 4å€‹ |
| ã‚¹ãƒ¬ãƒƒãƒ‰ä½¿ç”¨ | 2ç®‡æ‰€ |

---

## ğŸ¯ å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½

### âœ… å¿…é ˆæ©Ÿèƒ½

- [x] NavigationPanel çµ±åˆ
- [x] æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°
- [x] start_analysis() ãƒ¡ã‚½ãƒƒãƒ‰
- [x] ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†
- [x] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### âœ… è¿½åŠ æ©Ÿèƒ½

- [x] ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢
- [x] ãƒ“ãƒ¥ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
- [x] OCREngine çµ±åˆ
- [x] ContentAnalyzer çµ±åˆ
- [x] ä¸€æ‹¬ãƒãƒƒãƒãƒ³ã‚°æ©Ÿèƒ½

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆã‚³ãƒãƒ³ãƒ‰

```bash
# åŸºæœ¬ãƒ†ã‚¹ãƒˆ
python test_main_window.py

# ç›´æ¥èµ·å‹•
python app/gui/main_window.py
```

### ãƒ†ã‚¹ãƒˆé …ç›®

- âœ… ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦èµ·å‹•
- âœ… NavigationPanel è¡¨ç¤º
- âœ… ã‚¦ã‚§ãƒ«ã‚«ãƒ ç”»é¢è¡¨ç¤º
- âœ… ãƒ€ã‚¤ã‚¢ãƒ­ã‚°èµ·å‹•
- âœ… ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢
- âœ… ãƒ“ãƒ¥ãƒ¼åˆ‡æ›¿

---

## ğŸ“š ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

| ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ |
|---------|------|
| `docs/MAIN_WINDOW_INTEGRATION.md` | å®Œå…¨ãªçµ±åˆã‚¬ã‚¤ãƒ‰ |
| `test_main_window.py` | ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ |
| ã“ã®ãƒ•ã‚¡ã‚¤ãƒ« | å®Ÿè£…ã‚µãƒãƒªãƒ¼ |

---

## ğŸ’¡ ä¸»è¦ãªå¤‰æ›´ç‚¹

### Beforeï¼ˆæ—§main_window.py - 72è¡Œï¼‰

```python
# ç°¡æ˜“çš„ãªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
self.btn_macro = ctk.CTkButton(...)
self.btn_micro = ctk.CTkButton(...)

# ãƒ“ãƒ¥ãƒ¼ã®åˆæœŸåŒ–
self.macro_view = MacroView(self.content_area)
self.micro_view = MicroView(self.content_area)
```

### Afterï¼ˆæ–°main_window.py - 350è¡Œï¼‰

```python
# NavigationPanelçµ±åˆ
self.nav_panel = NavigationPanel(
    self.main_container,
    callbacks=nav_callbacks,
    width=220
)

# ã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆ
self.ocr_engine = OCREngine(...)
self.analyzer = ContentAnalyzer(...)

# æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ©Ÿèƒ½
def open_new_project_dialog(self):
    dialog = ProjectDialog(self, on_start=self.start_analysis)

def start_analysis(self, config):
    # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†...
```

---

## ğŸŠ é”æˆã—ãŸç›®æ¨™

| è¦ä»¶ | çŠ¶æ…‹ | å®Ÿè£… |
|------|------|------|
| NavigationPanelä½¿ç”¨ | âœ… | å®Œäº† |
| ã€Œâ•æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ãƒœã‚¿ãƒ³ | âœ… | å®Œäº† |
| ProjectDialogçµ±åˆ | âœ… | å®Œäº† |
| start_analysis()å®Ÿè£… | âœ… | å®Œäº† |
| ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç† | âœ… | threadingä½¿ç”¨ |
| ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º | âœ… | ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ |
| ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° | âœ… | try-exceptå®Œå‚™ |
| ContentAnalyzerçµ±åˆ | âœ… | å®Œäº† |

---

## ğŸ”œ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### çŸ­æœŸ
- [ ] EnhancedScraper ã®å®Œå…¨çµ±åˆ
- [ ] PDFLoader ã®å®Œå…¨çµ±åˆ
- [ ] OCRå‡¦ç†ã®è©³ç´°å®Ÿè£…

### ä¸­æœŸ
- [ ] Excelå‡ºåŠ›æ©Ÿèƒ½
- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¿å­˜/èª­è¾¼
- [ ] è©³ç´°ãƒ­ã‚°ãƒ“ãƒ¥ãƒ¼ã‚¢

---

## ğŸŒŸ ãƒã‚¤ãƒ©ã‚¤ãƒˆ

### 1. **å˜ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ**
`app/gui/main_window.py` ã‹ã‚‰å…¨æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

### 2. **NavigationPanelçµ±åˆ**
ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ™ãƒ¼ã‚¹ã§æŸ”è»Ÿãªè¨­è¨ˆ

### 3. **ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†**
GUIãŒãƒ•ãƒªãƒ¼ã‚ºã—ãªã„å¿«é©ãªæ“ä½œ

### 4. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
ãƒ­ãƒã‚¹ãƒˆãªè¨­è¨ˆã§ã‚¨ãƒ©ãƒ¼ã«å¼·ã„

### 5. **ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼è¨­è¨ˆ**
ãƒ“ãƒ¥ãƒ¼ã€ã‚¨ãƒ³ã‚¸ãƒ³ã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒç–çµåˆ

---

**ğŸ‰ MainWindow çµ±åˆå®Œäº†ï¼**

NavigationPanel ã¨æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ©Ÿèƒ½ã‚’å®Œå…¨çµ±åˆã—ã€å˜ä¸€ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã‹ã‚‰å…¨ã¦ã®æ©Ÿèƒ½ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†ã«ã‚ˆã‚Šã€å¿«é©ãªæ“ä½œä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚

