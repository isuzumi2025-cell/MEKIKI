# AI-OCR Workspace (Pro) ユーザーマニュアル

## 目次
1. [画面構成](#画面構成)
2. [機能ガイド](#機能ガイド)
3. [トラブルシューティング](#トラブルシューティング)

---

## 画面構成

### メインウィンドウ

AI-OCR Workspace (Pro)の画面は、以下の3つの主要エリアで構成されています：

#### 1. **ナビゲーションパネル（左側）**
- すべての操作ボタンが配置されたサイドバー
- 初期状態では、メインウィンドウの左側にドッキング（固定）されています
- セクション別に整理されています：
  - **📂 読込**: ファイルやWebページの読み込み
  - **✏️ 編集**: AI解析や範囲指定OCR
  - **⚖️ 比較**: 原稿比較・校正機能
  - **💾 出力**: データの保存やエクスポート
  - **🗔 ウィンドウ**: ウィンドウ管理

#### 2. **画像エディタエリア（中央上部）**
- 画像の表示と編集を行うメインエリア
- マウスで範囲を指定してOCRを実行できます
- 検出されたテキストエリアは赤枠で表示されます

#### 3. **テキスト結果エリア（中央下部）**
- OCRで抽出されたテキストが表示されます
- テキストは編集可能です
- ウィンドウ分離機能で別ウィンドウに表示することも可能です

#### 4. **ステータスバー（最下部）**
- 現在の作業状況やファイル名が表示されます
- 処理中の状態やエラーメッセージもここに表示されます

### ナビゲーションパレットの分離・結合

**画面を広く使いたい場合**は、ナビゲーションパネルを分離して別ウィンドウに移動できます。

#### パレットを分離する方法
1. ナビゲーションパネル上部の「🗔 パレット分離」ボタンをクリック
2. パネルが独立したウィンドウ（パレットウィンドウ）として表示されます
3. メインウィンドウの画像エディタエリアが広くなります

#### パレットを結合する方法
1. パレットウィンドウ上部の「📥 パレット結合」ボタンをクリック
2. または、パレットウィンドウを閉じる（×ボタン）
3. パネルがメインウィンドウの左側に戻ります

**ヒント**: 
- 大きな画像を扱う場合は、パレットを分離すると作業領域が広がり、作業効率が向上します
- パレットウィンドウは、メインウィンドウの前面に自動的に表示されます

---

## 機能ガイド

### 1. ファイルの読み込み

#### 画像/PDFファイルの読み込み
1. ナビゲーションパネルの「画像/PDF」ボタンをクリック
2. ファイル選択ダイアログから、画像ファイル（PNG、JPG、JPEG）またはPDFファイルを選択
3. 画像がエディタエリアに表示されます

#### Webページの読み込み（高画質スクリーンショット）
1. ナビゲーションパネルの「🌐 Web読込」ボタンをクリック
2. Web読込設定ダイアログが表示されます
3. **対象URL**に、読み込みたいWebページのURLを入力
4. 認証が必要な場合は：
   - **ユーザー名**と**パスワード**を入力して「⬇ テキスト取得」をクリック
   - または、「🔑 認証モード(画面操作)」でブラウザを使ってログイン
5. 読み込みが完了すると、Webページのスクリーンショットが表示されます
6. 範囲指定OCRスイッチが自動的にONになります

**Web読込の特徴**:
- 高画質なスクリーンショットを取得します
- HTMLテキストも同時に取得されます
- 「全体」と「1画面」の表示モードを切り替えられます

---

### 2. AI解析（OCR）

#### 全体AI解析
1. 画像を読み込んだ後、「▶ 全体AI解析」ボタンをクリック
2. Google Cloud Vision APIを使用して、画像全体からテキストを抽出します
3. 抽出されたテキストエリアは赤枠で表示され、テキスト結果エリアに表示されます

**注意**: 
- Google Cloud Vision APIの認証設定が必要です
- 環境変数 `GOOGLE_APPLICATION_CREDENTIALS` が設定されている必要があります

#### 範囲指定OCR
部分的なテキストだけを抽出したい場合に使用します。

1. ナビゲーションパネルの「範囲指定OCR」スイッチをONにする
2. 画像エディタエリアで、抽出したい範囲をマウスでドラッグして選択
3. 自動的にOCRが実行され、選択範囲のテキストが抽出されます
4. 抽出されたテキストは、テキスト結果エリアの末尾に追加されます

**使い方のコツ**:
- Webページのバナーや画像内の文字を抽出する際に便利です
- 大きな画像の特定箇所だけを読み取りたい場合にも有効です
- スイッチをOFFにすると、通常の編集モード（範囲選択でエリアを作成）に戻ります

---

### 3. 原稿比較・校正機能

2つの異なるテキストデータソースを比較して、差異を確認できます。

#### 比較モードの使い方
1. ナビゲーションパネルの「比較モード」ボタンをクリック
2. 比較モードウィンドウが開きます

3. **共通画像の読み込み（オプション）**:
   - 「📷 画像を読み込む」ボタンで画像を読み込み
   - 比較対象の元画像を表示できます

4. **テキストデータの入力**:
   - **Source A**: OCR結果などの元データを入力（現在のOCR結果があれば自動入力されます）
   - **Source B**: Webスクレイピング結果などの比較対象データを入力

5. **比較実行**:
   - 「⚖️ 比較実行」ボタンをクリック
   - 類似パラグラフが自動的にマッチングされ、比較結果が表示されます

6. **結果の確認**:
   - 左側にSource A、右側にSource Bの結果が表示されます
   - 各行に「Area ID」と「シンクロ率」が表示されます
   - 差異がある箇所は色分けされて表示されます：
     - **緑色背景**: 完全一致
     - **赤色背景**: 差異あり
     - **黄色背景**: 片方のみ存在

7. **結果の出力**:
   - 「📊 Google Sheets出力」ボタンで、比較結果をスプレッドシートに出力できます

---

### 4. データの出力

#### プロジェクトの保存・読込
- **プロジェクト保存**: 画像ファイルとOCR結果をセットで保存
- **プロジェクト読込**: 保存したプロジェクトを読み込み

#### CSV出力
- 抽出されたテキストをCSV形式で保存

#### Google Sheets出力
1. 「Google Sheets」ボタンをクリック
2. Google Sheets出力設定ダイアログで：
   - **スプレッドシートのURL**を入力（既存シートを使用する場合）
   - または**保存先フォルダのURL**を指定（新規作成する場合）
   - **共有するGmailアドレス**を入力
3. 「出力実行」をクリック

**注意**: 
- Google Sheets APIの認証が必要です
- `service_account.json` ファイルが必要です

---

### 5. ウィンドウ管理

#### テキスト結果の分離/結合
- 「テキスト分離/結合」ボタンで、テキスト結果エリアを別ウィンドウに表示/戻すことができます
- 大きなテキストを編集する際に便利です

---

## トラブルシューティング

### Q1: 画像が大きすぎてエラーが出る

**A**: 
- アプリケーションは自動的に画像を表示領域に合わせてリサイズします
- 非常に大きな画像の場合は、メモリ不足になる可能性があります
- その場合は、画像編集ソフトで事前にリサイズしてから読み込むことをお勧めします

### Q2: Google Cloud Vision APIのエラーが出る

**A**: 
- 環境変数 `GOOGLE_APPLICATION_CREDENTIALS` が正しく設定されているか確認してください
- 認証ファイル（JSON）のパスが正しいか確認してください
- Google Cloud プロジェクトでVision APIが有効になっているか確認してください

### Q3: Web読込で401エラーが出る

**A**: 
- 認証が必要なWebページの場合、ユーザー名とパスワードを入力してください
- 「🔑 認証モード(画面操作)」を使用して、ブラウザでログインしてからテキストを取得することも可能です

### Q4: ナビゲーションパネルが見つからない

**A**: 
- パネルが分離されている可能性があります
- タスクバーで「ナビゲーションパレット」ウィンドウを探してください
- または、パレットウィンドウを閉じてから、メインウィンドウを再起動してください

### Q5: OCRの精度が低い

**A**: 
- 画像の解像度が低い場合は、より高解像度の画像を使用してください
- 画像が傾いている場合は、事前に画像編集ソフトで補正してください
- 範囲指定OCRを使用して、部分的に精度の高いOCRを実行することも可能です

### Q6: 比較モードでシンクロ率が低い

**A**: 
- 比較対象のテキストのフォーマットが大きく異なる場合、シンクロ率が低くなることがあります
- テキストの前後にある空白や改行を統一すると、精度が向上することがあります

---

## その他のヒント

### 作業効率を上げるコツ
- **大きな画像を扱う場合**: ナビゲーションパネルを分離して、作業領域を広げる
- **部分的にOCRしたい場合**: 範囲指定OCRスイッチをONにして、必要な箇所だけを抽出
- **テキストを編集する場合**: テキスト結果エリアを別ウィンドウに分離して、広い画面で編集

### ショートカット・操作
- **右クリック**: 画像エディタエリアで選択したエリアを削除
- **マウスドラッグ**: 範囲を選択してエリアを作成、または範囲指定OCRを実行

---

**バージョン**: 1.0  
**最終更新**: 2025年

