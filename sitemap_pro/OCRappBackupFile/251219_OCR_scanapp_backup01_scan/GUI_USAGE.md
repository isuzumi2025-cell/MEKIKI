# GUIアプリケーション使用ガイド

## 起動方法

```bash
python -m app gui
```

または

```bash
python -m app --gui
```

## 機能説明

### 1. 認証設定

#### サービスアカウントキー（推奨）
1. 「サービスアカウントキー（JSONファイル）」を選択
2. 「参照...」ボタンをクリックしてJSONファイルを選択
3. Google Cloud ConsoleでサービスアカウントキーをダウンロードしたJSONファイルを指定

#### APIキー（簡易版）
1. 「APIキー（直接入力）」を選択
2. APIキーを入力欄に入力
3. **注意**: APIキー方式はセキュリティ上推奨されません

### 2. 入力設定

- **入力ファイル/ディレクトリ**: 処理する画像ファイル（JPG/PNG）またはPDFファイルを選択
- **クライアント名**: 出力先のクライアント名（例: `test_client`）
- **キャンペーン名**: 出力先のキャンペーン名（例: `test_campaign`）
- **月（YYYY-MM）**: オプション。指定しない場合は現在の月が使用されます
- **デバッグモード**: チェックすると、デバッグオーバーレイ画像が生成されます

### 3. 実行

1. 「OCR処理を実行」ボタンをクリック
2. 実行ログエリアで処理の進行状況を確認
3. 処理が完了すると、結果が表示されます

### 4. 環境変数の保存

「環境変数を保存」ボタンをクリックすると、入力した認証情報が `.env` ファイルに保存されます。
次回起動時は、保存された設定が自動的に読み込まれます。

## 出力先

処理結果は以下のディレクトリに保存されます：

```
library/{クライアント名}/{キャンペーン名}/{月}/
├── source/          # 入力ファイルのコピー
├── preprocessed/    # 前処理済み画像
├── ocr/             # OCR生結果（JSON）
├── normalized/      # 正規化JSON（normalized.json）
└── debug/           # デバッグオーバーレイ画像（デバッグモードON時）
```

## トラブルシューティング

### 「Google Cloud Vision API クライアントが作成できません」エラー

- サービスアカウントキーファイルのパスが正しいか確認
- JSONファイルが有効か確認
- Google Cloud ConsoleでVision APIが有効になっているか確認

### 「入力パスが存在しません」エラー

- ファイルパスが正しいか確認
- ファイルが削除されていないか確認

### 処理が完了しない

- 実行ログを確認してエラーメッセージを確認
- インターネット接続を確認（Google Cloud Vision APIへの接続が必要）
- APIキー/サービスアカウントキーが有効か確認



