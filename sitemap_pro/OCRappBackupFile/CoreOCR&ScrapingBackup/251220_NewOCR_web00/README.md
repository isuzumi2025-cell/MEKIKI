# 📷 高精度OCRアプリ (Pro版) 社内運用マニュアル

## 📌 アプリの概要
Google Cloud Vision APIを利用した高精度の文字起こしツールです。
画像やPDFから文字を読み取り、手動で修正した後、GoogleスプレッドシートやCSVに出力できます。

---

## 🛠️ 環境構築手順（初回のみ）

このアプリを使用するには、以下の準備が必要です。

### 1. 必要なソフトのインストール
パソコンに **Python 3.11以上** がインストールされている必要があります。

### 2. ライブラリのセットアップ
ターミナル（PowerShellやコマンドプロンプト）でプロジェクトフォルダを開き、以下を実行して必要な機能をインストールします。

```bash
pip install Pillow google-cloud-vision gspread requests pdf2image google-auth

3. Google認証鍵の配置
管理者から配布された service_account.json （ロボットの合鍵）を、このフォルダの直下（appフォルダと同じ場所）に置いてください。 ※ これがないとAIもスプレッドシートも動きません。

⚙️ Googleスプレッドシート出力の準備（重要！）
【注意】 システムの制限により、アプリから新しいスプレッドシートを自動作成することはできません。 出力したい場合は、以下の手順で「書き込み先のシート」を先に用意してください。

空のシートを作成 ブラウザでGoogleドライブを開き、新規のスプレッドシートを作成します。（名前は「OCR結果_〇〇案件」など自由に）

ロボットを招待（共有設定） 右上の「共有」ボタンを押し、以下のロボット用メールアドレスを招待してください。

権限: 「編集者」に設定すること

招待アドレス: （ここに check_account.py で確認したメールアドレスを記入してください）

URLをコピー そのスプレッドシートの URL をコピーしておきます。出力時に使用します。

🚀 アプリの使い方
1. 起動方法
ターミナルで以下のコマンドを入力して起動します。
python app/gui/main_window.py

2. 基本操作フロー
📂 画像を開く: 読み取りたい画像やPDFを選択します。

▶ 自動解析実行: AIが文字を読み取ります（数秒かかります）。

修正作業:

範囲修正: マウスでドラッグして新しい読み取り範囲を作れます。

削除: 右クリックで誤った枠を消せます。

文字修正: 画面右側のテキストエリアで、読み取った文字を直接修正できます。

💾 プロジェクト保存: 作業を中断したい場合、現在の状態をフォルダごと保存できます。

3. データ出力
編集が終わったら、以下のいずれかで出力します。

📊 CSV出力: シンプルなデータとしてパソコンに保存します。

Google Sheets出力:

ボタンを押すと入力画面が出ます。

「スプレッドシート名」の欄に、準備した【シートのURL】を貼り付けます。

「出力開始」を押すと、指定したシートにデータが書き込まれます。

⚠️ トラブルシューティング
Q. 「Output failed...」等のエラーが出る

A. スプレッドシートのURLは正しいですか？

A. そのシートにロボットのアドレスを「編集者」として招待しましたか？

Q. 起動しない（ModuleNotFoundError）

A. pip install ... の手順を行いましたか？仮想環境が変わっていないか確認してください。

📝 開発者向け情報 (仕様・更新用)
ファイル構成
app/gui/main_window.py: アプリの画面・メイン処理

app/utils/exporter.py: CSV/スプレッドシート出力処理（URL書き込み対応版）

app/core/engine_cloud.py: Google Vision APIとの通信処理


---

### 今後の運用アドバイス

1.  **メールアドレスの共有:**
    マニュアル内の `（ここに...メールアドレスを記入）` の部分には、先日 `check_account.py` で確認した **`xxxx@xxxx.iam.gserviceaccount.com`** というアドレスを実際に書き込んでから配布してください。これが一番重要です。

2.  **`service_account.json` の管理:**
    このファイルは「鍵」ですので、メールなどで送る際は社外に流出しないよう注意してください。社内の共有サーバーのアクセス制限された場所に置き、「ここからコピーしてね」と案内するのが安全です。

3.  **仕様追加時の更新:**
    今後機能を追加した際は、この `README.md` の「開発者向け情報」の下に更新履歴を追記していくと、誰がいつ何を変えたか分かりやすくなります。

これで、あなたのPCだけでなく、社内の他のメンバーも同じ手順で環境構築ができるようになります！